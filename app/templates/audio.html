{% extends 'base.html' %} {% block head %}
<title>Audio | New Utility</title>
{% endblock %} {% block styles %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/audio.css') }}"
/>
{% endblock %} {% block body %}
<div id="left-column">
  <div id="title-container">
    <h1>New Utility</h1>
  </div>
  <div class="main-row">
    <div class="section-title-div">
      <h2 id="section-title">Audio</h2>
    </div>
    <div id="history-section">
      <h2>History</h2>
      <div id="tts-history">
        <h3>Text-to-Speech History</h3>
        <ul>
          {% for job in TTSJobs %} {% if job.output_filename %}
          <li
            class="history-entry"
            data-job-id="{{ job.id }}"
            onclick="toggleDetails('{{ job.id }}', 'tts')"
          >
            <div class="history-summary">
              {{ job.created_at }} - {{ job.voice }}
            </div>
            <div
              class="history-details"
              id="tts-details-{{ job.id }}"
              style="display: none"
            >
              <p>Model: {{ job.model }}</p>
              <p>Speed: {{ job.speed }}</p>
              <audio controls>
                <source
                  src="{{ url_for('audio.download_tts', filename=job.output_filename) }}"
                  type="audio/mpeg"
                />
                Your browser does not support the audio element.
              </audio>
              <a
                href="{{ url_for('audio.download_tts', filename=job.output_filename) }}"
                download
                >Download Audio</a
              >
            </div>
          </li>
          {% endif %} {% endfor %}
        </ul>
      </div>
      <div id="transcription-history">
        <h3>Transcription History</h3>
        <ul>
          {% for job in TranscriptionJobs %} {% if job.finished %}
          <li
            class="history-entry"
            data-job-id="{{ job.id }}"
            onclick="toggleDetails('{{ job.id }}', 'transcription')"
          >
            <div class="history-summary">
              {{ job.created_at }} - {{ job.input_filename }}
            </div>
            <div
              class="history-details"
              id="transcription-details-{{ job.id }}"
              style="display: none"
            >
              <p>Language: {{ job.language }}</p>
              <p>Model: {{ job.model }}</p>
              <p>Temperature: {{ job.temperature }}</p>
              <p>Prompt: {{ job.prompt }}</p>
              <a
                href="{{ url_for('audio.download_whisper', job_id=job.id) }}"
                download
              >
                <i class="fas fa-download"></i> Download Transcription
              </a>
            </div>
          </li>
          {% endif %} {% endfor %}
        </ul>
      </div>
      <div id="translation-history">
        <h3>Translation History</h3>
        <ul>
          {% for job in TranslationJobs %} {% if job.finished %}
          <li
            class="history-entry"
            data-job-id="{{ job.id }}"
            onclick="toggleDetails('{{ job.id }}', 'translation')"
          >
            <div class="history-summary">
              {{ job.created_at }} - {{ job.input_filename }}
            </div>
            <div
              class="history-details"
              id="translation-details-{{ job.id }}"
              style="display: none"
            >
              <p>Model: {{ job.model }}</p>
              <p>Temperature: {{ job.temperature }}</p>
              <p>Prompt: {{ job.prompt }}</p>
              <a
                href="{{ url_for('audio.download_whisper', job_id=job.id) }}"
                download
              >
                <i class="fas fa-download"></i> Download Translation
              </a>
            </div>
          </li>
          {% endif %} {% endfor %}
        </ul>
      </div>
    </div>
    <div class="audio-column">
      <div class="audio-utility-container">
        <div class="utility-toggle">
          <i class="fas fa-microphone-alt" data-utility="tts"></i>
          <i class="fas fa-file-audio" data-utility="transcription"></i>
          <i class="fas fa-language" data-utility="translation"></i>
        </div>
        <div id="tts-utility" class="utility" style="display: flex">
          <form id="tts-form" method="post">
            <h3>Text-to-Speech</h3>
            <div class="form-group">
              {{ tts_form.input.label(for='tts-input') }} {{
              tts_form.input(id='tts-input', required=True) }}
            </div>
            <input type="submit" value="Generate Speech" />
          </form>
        </div>
        <div id="transcription-utility" class="utility" style="display: none">
          <form
            id="transcription-form"
            method="post"
            enctype="multipart/form-data"
          >
            <h3>Transcription</h3>
            <div class="form-group">
              {{ transcription_form.file.label(for='transcription-file') }} {{
              transcription_form.file(id='transcription-file', required=True,
              accept="audio/*") }}
            </div>

            <div class="form-group">
              {{ transcription_form.prompt_option.label }}
              <div>
                {% for subfield in transcription_form.prompt_option %}
                <div class="radio">{{ subfield }} {{ subfield.label }}</div>
                {% endfor %}
              </div>
            </div>
            <div
              class="form-group"
              id="manual-prompt-group"
              style="display: none"
            >
              {{ transcription_form.prompt.label(for='transcription-prompt') }}
              {{ transcription_form.prompt(id='transcription-prompt',
              class_='form-control') }}
            </div>
            <div
              class="form-group"
              id="generate-prompt-group"
              style="display: none"
            >
              {{ transcription_form.generate_prompt.label(for='generate-prompt')
              }} {{ transcription_form.generate_prompt(id='generate-prompt',
              class_='form-control') }}
            </div>

            <input type="submit" value="Transcribe" />
          </form>
        </div>
        <div id="translation-utility" class="utility" style="display: none">
          <!-- Translation Form -->
          <form
            id="translation-form"
            method="post"
            enctype="multipart/form-data"
          >
            <h3>Translation</h3>
            <div class="form-group">
              {{ translation_form.file.label(for='translation-file') }} {{
              translation_form.file(id='translation-file', required=True,
              accept="audio/*") }}
            </div>
            <div class="form-group">
              {{ translation_form.prompt_option.label }}
              <div>
                {% for subfield in translation_form.prompt_option %}
                <div class="radio">{{ subfield }} {{ subfield.label }}</div>
                {% endfor %}
              </div>
            </div>
            <div
              class="form-group"
              id="manual-translation-prompt-group"
              style="display: none"
            >
              {{ translation_form.prompt.label(for='translation-prompt') }} {{
              translation_form.prompt(id='translation-prompt',
              class_='form-control') }}
            </div>
            <input type="submit" value="Translate" />
          </form>
        </div>
        <div class="audio-preferences-container">
          <form id="tts-preferences-form" method="post">
            <h3>Text-to-Speech Preferences</h3>
            <div class="form-group">
              {{ tts_preferences_form.model.label }} {{
              tts_preferences_form.model }}
            </div>
            <div class="form-group">
              {{ tts_preferences_form.voice.label }} {{
              tts_preferences_form.voice }}
            </div>
            <div class="form-group">
              {{ tts_preferences_form.speed.label }}
              <input
                type="range"
                id="speed"
                name="speed"
                min="0"
                max="4"
                step="0.25"
                value="{{ tts_preferences_form.speed.data }}"
                oninput="document.getElementById('speed-value').value = this.value"
              />
              <input
                type="text"
                id="speed-value"
                name="speed-value"
                class="range-value-input"
                value="{{ tts_preferences_form.speed.data }}"
                oninput="document.getElementById('speed').value = this.value"
              />
            </div>
            <input type="submit" value="Save TTS Preferences" />
          </form>
          <form id="whisper-preferences-form" method="post">
            <h3>Whisper Preferences</h3>
            <div class="form-group">
              {{ whisper_preferences_form.model.label }} {{
              whisper_preferences_form.model }}
            </div>
            <div class="form-group language">
              {{ whisper_preferences_form.language.label }} {{
              whisper_preferences_form.language(class_='form-control') }}
            </div>
            <div class="form-group">
              {{ whisper_preferences_form.response_format.label }} {{
              whisper_preferences_form.response_format }}
            </div>
            <div class="form-group">
              {{ whisper_preferences_form.temperature.label }}
              <input
                type="range"
                id="temperature"
                name="temperature"
                min="0"
                max="1"
                step="0.1"
                value="{{whisper_preferences_form.temperature.data }}"
                oninput="document.getElementById('temperature-value').value = this.value"
              />
              <input
                type="text"
                id="temperature-value"
                class="range-value-input"
                value="{{ whisper_preferences_form.temperature.data }}"
                oninput="document.getElementById('temperature').value = this.value"
              />
            </div>
            <input type="submit" value="Save Whisper Preferences" />
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/audio.js') }}"></script>
{% endblock %}
